local <IP server>
port 1194
proto udp4
dev tun

##########################################Test rules and commands##################################
# DEPRECATED!!! ifconfig-pool-linear
## Параметр проверки сертификата пользователя, по умолчанию включен verify-client-cert require, используется вместе с параметром 
## auth-user-pass на клиенте. Можно отключить - verify-client-cert none
#verify-client-cert require
## Auth TLS error
auth SHA512


##########################################  Work config cert ###################################### 
ca /etc/openvpn/server/ca.crt
cert /etc/openvpn/server/issued/name_sert.crt
key /etc/openvpn/server/private/name_key.key
dh /etc/openvpn/server/dh.pem
tls-auth /etc/openvpn/server/ta.key 0
cipher AES-256-GCM
crl-verify /etc/openvpn/server/crl.pem
tls-version-min 1.1
tls-version-max 1.3

############################################ Server Config parametrs start ###############################
mode server
topology subnet
ifconfig-pool-persist /etc/openvpn/server/client_conf/cahe_ip_tun 1200
client-config-dir /etc/openvpn/ccd
server 10.250.252.0 255.255.252.0
#Для сервера выделяем IP адреса, при "topology subnet" указываются параметры <IP> <netmask>. В отличии от "topology p2p или net30", где указываются <local IP> <remote IP>
ifconfig 10.250.252.1 255.255.252.0
# С параметром "server" параметр "ifconfig-pool" не стартует, т.к. запуск пула адресов уже произошёл.
#ifconfig-pool 10.250.255.4 10.250.255.251  -- сервер не стартует с этим параметром
#client-to-client
keepalive 10 120
## Не включать сжатие compress lz4-v2 НИКОГДА!!!!. ssh нормально не работает, RDP и полно глюков
# compress lz4-v2
## Параметр активации управляющего порта, можно подключатся и выполнять настройки OpenVPN сервера. 
management localhost 7505
## Подключаемый plugin для проверки имени пользователя и пароля через LDAP в AD Windows
## Для параметра auth-user-pass на клиенте, выполняет проверки пароля и имени.
## Наличие подключаемого плагина (plugin /usr/lib64/openvpn/plugins/openvpn-auth-ldap.so), требует ОБЯЗАТЕЛЬНОЙ auth на сервере, 
## если не выставлен параметр --auth-user-pass-optional, который разрешает подключение пользователя без ввода имени/пароля
plugin /usr/lib64/openvpn/plugins/openvpn-auth-ldap.so "/etc/openvpn/auth/ldap.conf"


############################################# Parametrs push to clients start########################
# Передаём клиентам DNS сети и домен поиска, для доступа к локальным компьютерам по именам:
push "dhcp-option DNS 172.18.1.16"
push "dhcp-option DNS 172.18.1.17"
push "dhcp-option DNS 192.168.50.8"
push "dhcp-option DOMAIN bgim.local"
## "DOMAIN-SEARCH" появился в openvpn начиная с 2.5 версии. С 2.0 версии параметр "DOMAIN", при том будет использоваться только одна, последняя запись.
#push "dhcp-option DOMAIN-SEARCH bgim.local"
push "dhcp-option DOMAIN-SEARCH gost.local"
# Передаём клиентам маршруты к сетям за VPN:
push "route 172.16.0.0 255.240.0.0"
push "route 178.124.164.104 255.255.255.248"
push "route 192.168.50.0 255.255.255.0"
## Параметры переданный на клиента, создаст дефолтовый маршрут через туннель:
#push "redirect-gateway"
## Завернуть весь трафик на клиенте в туннель:
#push "redirect-gateway def1 bypass-dhcp"
############################################## Parametrs push to clients end###########################

# Параметр link-mtu:
#link-mtu 1542
# Параметр tun-mtu связан с параметром mssfix, если он используется, то значение tun-mtu должно быть 1500:
tun-mtu 1500
mssfix 1300

#user nobody
#group nobody

persist-key
persist-tun

status /var/log/openvpn/openvpn-status.log
log-append /var/log/openvpn/openvpn.log
verb 3

# for udp only:
explicit-exit-notify 1
